<head>
  <%- partial('_partial/import', { resource: theme.import.head.before }) %>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, viewport-fit=cover">
  <% const title = page.title ? `${page.title} | ${config.title}` : config.title %>
  <title><%= title %></title>
  <%- favicon_tag(theme.favicon) %>
  <% 
    const themeOg = theme.open_graph || {};
    const removeNoPreviewBlocks = (input = '') => input.replace(/<!--\s*no_preview:start\s*-->[\s\S]*?<!--\s*no_preview:end\s*-->/gi, '');
    const stripHtml = typeof strip_html === 'function' ? strip_html : (value) => value;
    let computedDescription = themeOg.description || page.description;
    if (!computedDescription) {
      const sourceForPreview = page.excerpt || page.more || page.content || '';
      const cleaned = removeNoPreviewBlocks(sourceForPreview).trim();
      if (cleaned) {
        const stripped = stripHtml(cleaned);
        computedDescription = stripped.replace(/\s+/g, ' ').trim();
      }
    }
    const ogOptions = computedDescription
      ? Object.assign({}, themeOg, { description: computedDescription })
      : themeOg;
  %>
  <%- open_graph(ogOptions) %>
  <%- css('css/style') %>
  
  <% if(is_page() || is_post()){ %>
  <%- js({ src: 'js/image-preview.js', defer: true }) %>
  <% } %>
  <%- js({ src: 'js/main.js', defer: true }) %>
  <%- partial('_partial/import', { resource: theme.import.head.after }) %>


  <script async src="https://www.googletagmanager.com/gtag/js?id=G-GGNJQPMSZD"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-GGNJQPMSZD');
  </script>

  <script defer src="https://cloud.umami.is/script.js" data-website-id="9e62400f-44bc-466c-8728-ee2155c369cb"></script>

</head>
